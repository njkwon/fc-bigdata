{"paragraphs":[{"title":"1. Read CSV s3에 있는 csv 파일을 읽는다. ","text":"val csvDF = spark.read\n  .option(\"header\", \"true\")\n  .option(\"delimiter\", \",\")  \n  .option(\"inferSchema\",\"true\")\n  .csv(\"s3://fc-datapipeline/danji_master.csv\")\n  \n  ","user":"anonymous","dateUpdated":"2020-12-07T05:50:24+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","title":true,"results":{},"enabled":true,"fontSize":9},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1607319217198_458256809","id":"20181003-073124_50873724","dateCreated":"2020-12-07T05:33:37+0000","dateStarted":"2020-12-07T05:50:24+0000","dateFinished":"2020-12-07T05:50:36+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:7510","errorMessage":""},{"title":"파일 확인하기","text":"csvDF.show","user":"anonymous","dateUpdated":"2020-12-07T05:38:53+0000","config":{"colWidth":12,"editorMode":"ace/mode/scala","results":{},"enabled":true,"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"fontSize":9,"editorHide":false,"title":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1607319217204_2126463281","id":"20181006-034430_1168827932","dateCreated":"2020-12-07T05:33:37+0000","dateStarted":"2020-12-07T05:38:12+0000","dateFinished":"2020-12-07T05:38:15+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:7511"},{"title":"DataFrame 생성","text":"csvDF.show","user":"anonymous","dateUpdated":"2020-12-07T05:42:08+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","title":true,"results":{},"enabled":true,"fontSize":9},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1607319217205_-391250089","id":"20181003-073753_976254529","dateCreated":"2020-12-07T05:33:37+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:7512"},{"title":"DataFrame의 각 속성값의 Data type을 확인한다.","text":"csvDF.printSchema","user":"anonymous","dateUpdated":"2020-12-07T05:51:34+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala","title":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1607320242675_-82190245","id":"20201207-055042_1777079225","dateCreated":"2020-12-07T05:50:42+0000","dateStarted":"2020-12-07T05:51:00+0000","dateFinished":"2020-12-07T05:51:01+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:7513"},{"title":"View Table 정의","text":"csvDF.createOrReplaceTempView(\"danji_master_csv\")","user":"anonymous","dateUpdated":"2020-12-07T05:42:18+0000","config":{"colWidth":12,"editorMode":"ace/mode/scala","results":{},"enabled":true,"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"fontSize":9,"title":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1607319217205_-670662652","id":"20181003-074033_1164745725","dateCreated":"2020-12-07T05:33:37+0000","dateStarted":"2020-12-07T05:42:18+0000","dateFinished":"2020-12-07T05:42:19+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:7514"},{"title":"Spark SQL 수행","text":"%sql\nselect *\nfrom danji_master_csv","user":"anonymous","dateUpdated":"2020-12-07T05:43:07+0000","config":{"editorSetting":{"language":"sql","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/sql","title":true,"results":{"0":{"graph":{"mode":"table","height":300,"optionOpen":false,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{"id":"string","danji_name":"string","sido":"string","sigungu":"string","dong":"string","address2":"string","new_address":"string","house_count":"string","dong_count":"string","build_ym":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false}},"commonSetting":{}}}},"enabled":true,"fontSize":9},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1607319217206_97551970","id":"20181003-074118_1615665441","dateCreated":"2020-12-07T05:33:37+0000","dateStarted":"2020-12-07T05:43:07+0000","dateFinished":"2020-12-07T05:43:07+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:7515"},{"title":"2.Write JSON - 하나의 파일로 쓴다","text":"csvDF.coalesce(1)\n      .write\n      .mode(\"Overwrite\")\n      .format(\"json\")\n      .save(\"s3://fc-datapipeline/target/data33/master/json/\")\n  ","user":"anonymous","dateUpdated":"2020-12-07T05:54:37+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","title":true,"results":{},"enabled":true,"fontSize":9},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1607319217206_-359526041","id":"20181003-074558_441652199","dateCreated":"2020-12-07T05:33:37+0000","dateStarted":"2020-12-07T05:54:37+0000","dateFinished":"2020-12-07T05:54:48+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:7516"},{"title":"Read JSON","text":"val jsonDF = spark.read.json(\"s3://fc-datapipeline/target/data33/master/json/part-00000-2a8f8112-091e-4791-8f52-e18b2d15e131-c000.json\")\n","user":"anonymous","dateUpdated":"2020-12-07T06:04:53+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","title":true,"results":{},"enabled":true,"fontSize":9},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1607319217206_1702836764","id":"20181003-073139_1074440342","dateCreated":"2020-12-07T05:33:37+0000","dateStarted":"2020-12-07T06:04:53+0000","dateFinished":"2020-12-07T06:05:03+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:7517","errorMessage":""},{"title":"DataFrame","text":"jsonDF.show","user":"anonymous","dateUpdated":"2020-12-07T06:11:57+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","title":true,"results":{},"enabled":true,"fontSize":9},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1607319217207_-429685744","id":"20181003-075759_1817411365","dateCreated":"2020-12-07T05:33:37+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:7518"},{"text":"jsonDF.printSchema","user":"anonymous","dateUpdated":"2020-12-07T06:05:20+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1607321110780_772104101","id":"20201207-060510_318603071","dateCreated":"2020-12-07T06:05:10+0000","dateStarted":"2020-12-07T06:05:20+0000","dateFinished":"2020-12-07T06:05:20+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:7519","errorMessage":""},{"text":"jsonDF.createOrReplaceTempView(\"danji_master_json\")","user":"anonymous","dateUpdated":"2020-12-07T06:40:21+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","title":true,"results":{},"enabled":true,"fontSize":9},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1607319217207_-311456634","id":"20181003-075815_1415430203","dateCreated":"2020-12-07T05:33:37+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:7520","title":"View Table 생성 ","dateFinished":"2020-12-07T06:40:22+0000","dateStarted":"2020-12-07T06:40:21+0000"},{"title":"Spark SQL","text":"%sql\nselect *\nfrom danji_master_json","user":"anonymous","dateUpdated":"2020-12-07T06:40:36+0000","config":{"editorSetting":{"language":"sql","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/sql","title":true,"results":{"0":{"graph":{"mode":"table","height":300,"optionOpen":false,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{"address2":"string","build_ym":"string","danji_name":"string","dong":"string","dong_count":"string","house_count":"string","id":"string","new_address":"string","sido":"string","sigungu":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false}},"commonSetting":{}}}},"enabled":true,"fontSize":9},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1607319217208_-1092951250","id":"20181003-075909_1317205834","dateCreated":"2020-12-07T05:33:37+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:7521","dateFinished":"2020-12-07T06:40:35+0000","dateStarted":"2020-12-07T06:40:25+0000"},{"title":"3.Write Parquet","text":"jsonDF.write\n      .mode(\"Overwrite\")\n      .format(\"parquet\")\n      .save(\"s3://fc-datapipeline/target/data33/master/parquet/\")","user":"anonymous","dateUpdated":"2020-12-07T06:40:56+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","title":true,"results":{},"enabled":true,"fontSize":9},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1607319217208_240715363","id":"20181003-080331_1677788740","dateCreated":"2020-12-07T05:33:37+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:7522","dateFinished":"2020-12-07T06:40:57+0000","dateStarted":"2020-12-07T06:40:56+0000"},{"title":"Read Parquet","text":"val parquetDF = spark.read.parquet(\"s3://fc-datapipeline/target/data33/master/parquet/\")\n","user":"anonymous","dateUpdated":"2020-12-07T06:41:27+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","title":true,"results":{},"enabled":true,"fontSize":9},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"parquetDF: org.apache.spark.sql.DataFrame = [address2: string, build_ym: string ... 8 more fields]\n"}]},"apps":[],"jobName":"paragraph_1607319217208_-710142239","id":"20181003-073202_730174686","dateCreated":"2020-12-07T05:33:37+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:7523","dateFinished":"2020-12-07T06:41:28+0000","dateStarted":"2020-12-07T06:41:27+0000"},{"text":"parquetDF.printSchema","user":"anonymous","dateUpdated":"2020-12-07T06:41:30+0000","config":{"colWidth":12,"editorMode":"ace/mode/scala","results":{},"enabled":true,"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"fontSize":9},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1607319217209_1610498172","id":"20181003-084133_776337335","dateCreated":"2020-12-07T05:33:37+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:7524","dateFinished":"2020-12-07T06:41:30+0000","dateStarted":"2020-12-07T06:41:30+0000"},{"text":"parquetDF.createOrReplaceTempView(\"danji_master_pq\")\n","user":"anonymous","dateUpdated":"2020-12-07T06:41:36+0000","config":{"colWidth":12,"editorMode":"ace/mode/scala","results":{},"enabled":true,"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"fontSize":9},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1607319217209_706070471","id":"20181003-084131_537968080","dateCreated":"2020-12-07T05:33:37+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:7525","dateFinished":"2020-12-07T06:41:37+0000","dateStarted":"2020-12-07T06:41:37+0000"},{"text":"%sql\nselect *\nfrom danji_master_pq","user":"anonymous","dateUpdated":"2020-12-07T06:41:41+0000","config":{"editorSetting":{"language":"sql","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/sql","editorHide":false,"results":{"0":{"graph":{"mode":"table","height":300,"optionOpen":false,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{"address2":"string","build_ym":"string","danji_name":"string","dong":"string","dong_count":"string","house_count":"string","id":"string","new_address":"string","sido":"string","sigungu":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false}},"commonSetting":{}}}},"enabled":true,"fontSize":9},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1607319217209_-1169509248","id":"20181003-084238_933718271","dateCreated":"2020-12-07T05:33:37+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:7526","dateFinished":"2020-12-07T06:41:40+0000","dateStarted":"2020-12-07T06:41:39+0000"},{"title":"Write CSV","text":"parquetDF.coalesce(1)\n      .write\n      .mode(\"Overwrite\")\n      .format(\"csv\")\n      .save(\"s3://fc-datapipeline/target/data33/master/csv/\")","user":"anonymous","dateUpdated":"2020-12-07T06:47:16+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","title":true,"results":{},"enabled":true,"fontSize":9},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1607319217210_607623036","id":"20181003-073224_251924060","dateCreated":"2020-12-07T05:33:37+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:7527","dateFinished":"2020-12-07T06:47:27+0000","dateStarted":"2020-12-07T06:47:16+0000"},{"user":"anonymous","dateUpdated":"2020-12-07T05:33:37+0000","config":{"colWidth":12,"editorMode":"ace/mode/scala","results":{},"enabled":true,"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"fontSize":9},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1607319217210_60251830","id":"20181003-085104_906540279","dateCreated":"2020-12-07T05:33:37+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:7528"}],"name":"1.readSource-scala","id":"2FTMQBQ3V","noteParams":{},"noteForms":{},"angularObjects":{"spark:shared_process":[]},"config":{"isZeppelinNotebookCronEnable":false,"looknfeel":"default","personalizedMode":"false"},"info":{}}