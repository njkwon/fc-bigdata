{"paragraphs":[{"title":"1. Read CSV s3에 있는 csv 파일을 읽는다. ","text":"%pyspark \n\ncsvDF = spark.read  \\\n.option(\"header\", \"true\")  \\\n.option(\"delimiter\", \",\")  \\\n.option(\"inferSchema\",\"true\") \\\n.csv(\"\"\"s3://fc-datapipeline/\\\ndanji_master.csv\"\"\")\n  \n  ","user":"anonymous","dateUpdated":"2020-12-07T08:06:50+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","title":true,"results":{},"enabled":true,"fontSize":9},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1607319217198_458256809","id":"20181003-073124_50873724","dateCreated":"2020-12-07T05:33:37+0000","dateStarted":"2020-12-07T08:06:50+0000","dateFinished":"2020-12-07T08:07:48+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:30364"},{"title":"파일 확인하기","text":"%pyspark \n\ncsvDF.show()","user":"anonymous","dateUpdated":"2020-12-07T08:06:52+0000","config":{"colWidth":12,"editorMode":"ace/mode/python","results":{},"enabled":true,"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"fontSize":9,"editorHide":false,"title":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1607319217204_2126463281","id":"20181006-034430_1168827932","dateCreated":"2020-12-07T05:33:37+0000","dateStarted":"2020-12-07T08:06:55+0000","dateFinished":"2020-12-07T08:07:49+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:30365","errorMessage":""},{"title":"DataFrame의 각 속성값의 Data type을 확인한다.","text":"%pyspark\n\ncsvDF.printSchema()","user":"anonymous","dateUpdated":"2020-12-07T08:08:11+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python","title":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"root\n |-- id: integer (nullable = true)\n |-- danji_name: string (nullable = true)\n |-- sido: string (nullable = true)\n |-- sigungu: string (nullable = true)\n |-- dong: string (nullable = true)\n |-- address2: string (nullable = true)\n |-- new_address: string (nullable = true)\n |-- house_count: string (nullable = true)\n |-- dong_count: string (nullable = true)\n |-- build_ym: string (nullable = true)\n\n"}]},"apps":[],"jobName":"paragraph_1607320242675_-82190245","id":"20201207-055042_1777079225","dateCreated":"2020-12-07T05:50:42+0000","dateStarted":"2020-12-07T08:08:11+0000","dateFinished":"2020-12-07T08:08:11+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:30366"},{"title":"View Table 정의","text":"%pyspark \ncsvDF.createOrReplaceTempView(\"danji_master_csv\")","user":"anonymous","dateUpdated":"2020-12-07T08:08:13+0000","config":{"colWidth":12,"editorMode":"ace/mode/python","results":{},"enabled":true,"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"fontSize":9,"title":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1607319217205_-670662652","id":"20181003-074033_1164745725","dateCreated":"2020-12-07T05:33:37+0000","dateStarted":"2020-12-07T08:08:13+0000","dateFinished":"2020-12-07T08:08:13+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:30367"},{"title":"Spark SQL 수행","text":"%sql\nselect *\nfrom danji_master_csv","user":"anonymous","dateUpdated":"2020-12-07T08:08:17+0000","config":{"editorSetting":{"language":"sql","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/sql","title":true,"results":{"0":{"graph":{"mode":"table","height":300,"optionOpen":false,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{"id":"string","danji_name":"string","sido":"string","sigungu":"string","dong":"string","address2":"string","new_address":"string","house_count":"string","dong_count":"string","build_ym":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false}},"commonSetting":{}}}},"enabled":true,"fontSize":9},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1607319217206_97551970","id":"20181003-074118_1615665441","dateCreated":"2020-12-07T05:33:37+0000","dateStarted":"2020-12-07T08:08:17+0000","dateFinished":"2020-12-07T08:08:17+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:30368","errorMessage":""},{"title":"2.Write JSON - 하나의 파일로 쓴다","text":"%pyspark \n\ncsvDF.coalesce(1).write.mode(\"Overwrite\").format(\"json\").json(\"\"\"s3://fc-datapipeline/\\\ntarget/data33/master/json/\"\"\")\n  ","user":"anonymous","dateUpdated":"2020-12-07T08:11:16+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","title":true,"results":{},"enabled":true,"fontSize":9},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1607319217206_-359526041","id":"20181003-074558_441652199","dateCreated":"2020-12-07T05:33:37+0000","dateStarted":"2020-12-07T08:11:16+0000","dateFinished":"2020-12-07T08:11:27+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:30369"},{"title":"Read JSON","text":"%pyspark \n\njsonDF = spark.read.json(\"\"\"s3://fc-datapipeline/target/data33/master/json/\"\"\")\n","user":"anonymous","dateUpdated":"2020-12-07T08:15:14+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","title":true,"results":{},"enabled":true,"fontSize":9},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1607319217206_1702836764","id":"20181003-073139_1074440342","dateCreated":"2020-12-07T05:33:37+0000","dateStarted":"2020-12-07T08:15:14+0000","dateFinished":"2020-12-07T08:15:23+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:30370"},{"title":"DataFrame","text":"%pyspark \n\njsonDF.show()","user":"anonymous","dateUpdated":"2020-12-07T08:15:46+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","title":true,"results":{},"enabled":true,"fontSize":9},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1607319217207_-429685744","id":"20181003-075759_1817411365","dateCreated":"2020-12-07T05:33:37+0000","dateStarted":"2020-12-07T08:15:46+0000","dateFinished":"2020-12-07T08:15:46+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:30371"},{"text":"%pyspark \n\njsonDF.printSchema()","user":"anonymous","dateUpdated":"2020-12-07T08:15:48+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1607321110780_772104101","id":"20201207-060510_318603071","dateCreated":"2020-12-07T06:05:10+0000","dateStarted":"2020-12-07T08:15:48+0000","dateFinished":"2020-12-07T08:15:48+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:30372"},{"title":"View Table 생성 ","text":"%pyspark \n\njsonDF.createOrReplaceTempView(\"danji_master_json\")","user":"anonymous","dateUpdated":"2020-12-07T08:16:06+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","title":true,"results":{},"enabled":true,"fontSize":9},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1607319217207_-311456634","id":"20181003-075815_1415430203","dateCreated":"2020-12-07T05:33:37+0000","dateStarted":"2020-12-07T08:16:06+0000","dateFinished":"2020-12-07T08:16:06+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:30373"},{"title":"Spark SQL","text":"%sql\nselect *\nfrom danji_master_json","user":"anonymous","dateUpdated":"2020-12-07T08:16:10+0000","config":{"editorSetting":{"language":"sql","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/sql","title":true,"results":{"0":{"graph":{"mode":"table","height":300,"optionOpen":false,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{"address2":"string","build_ym":"string","danji_name":"string","dong":"string","dong_count":"string","house_count":"string","id":"string","new_address":"string","sido":"string","sigungu":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false}},"commonSetting":{}}}},"enabled":true,"fontSize":9},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1607319217208_-1092951250","id":"20181003-075909_1317205834","dateCreated":"2020-12-07T05:33:37+0000","dateStarted":"2020-12-07T08:16:10+0000","dateFinished":"2020-12-07T08:16:10+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:30374"},{"title":"3.Write Parquet","text":"%pyspark \n\njsonDF.write.mode(\"Overwrite\").format(\"parquet\")\\\n.save(\"s3://fc-datapipeline/target/data33/master/parquet/\")","user":"anonymous","dateUpdated":"2020-12-07T08:16:44+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","title":true,"results":{},"enabled":true,"fontSize":9},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1607319217208_240715363","id":"20181003-080331_1677788740","dateCreated":"2020-12-07T05:33:37+0000","dateStarted":"2020-12-07T08:16:44+0000","dateFinished":"2020-12-07T08:16:46+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:30375"},{"title":"Read Parquet","text":"%pyspark \n\nparquetDF = spark.read.parquet(\"s3://fc-datapipeline/target/data33/master/parquet/\")\n","user":"anonymous","dateUpdated":"2020-12-07T08:17:04+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","title":true,"results":{},"enabled":true,"fontSize":9},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1607319217208_-710142239","id":"20181003-073202_730174686","dateCreated":"2020-12-07T05:33:37+0000","dateStarted":"2020-12-07T08:17:04+0000","dateFinished":"2020-12-07T08:17:04+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:30376"},{"text":"%pyspark \n\nparquetDF.printSchema()","user":"anonymous","dateUpdated":"2020-12-07T08:17:15+0000","config":{"colWidth":12,"editorMode":"ace/mode/python","results":{},"enabled":true,"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"fontSize":9},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"root\n |-- address2: string (nullable = true)\n |-- build_ym: string (nullable = true)\n |-- danji_name: string (nullable = true)\n |-- dong: string (nullable = true)\n |-- dong_count: string (nullable = true)\n |-- house_count: string (nullable = true)\n |-- id: long (nullable = true)\n |-- new_address: string (nullable = true)\n |-- sido: string (nullable = true)\n |-- sigungu: string (nullable = true)\n\n"}]},"apps":[],"jobName":"paragraph_1607319217209_1610498172","id":"20181003-084133_776337335","dateCreated":"2020-12-07T05:33:37+0000","dateStarted":"2020-12-07T08:17:16+0000","dateFinished":"2020-12-07T08:17:16+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:30377"},{"text":"%pyspark\n\nparquetDF.createOrReplaceTempView(\"danji_master_pq\")\n","user":"anonymous","dateUpdated":"2020-12-07T09:29:22+0000","config":{"colWidth":12,"editorMode":"ace/mode/python","results":{},"enabled":true,"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"fontSize":9},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1607319217209_706070471","id":"20181003-084131_537968080","dateCreated":"2020-12-07T05:33:37+0000","dateStarted":"2020-12-07T09:29:22+0000","dateFinished":"2020-12-07T09:29:22+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:30378","results":{"code":"SUCCESS","msg":[]}},{"text":"%sql\nselect *\nfrom danji_master_pq","user":"anonymous","dateUpdated":"2020-12-07T09:29:25+0000","config":{"editorSetting":{"language":"sql","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/sql","editorHide":false,"results":{"0":{"graph":{"mode":"table","height":300,"optionOpen":false,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{"address2":"string","build_ym":"string","danji_name":"string","dong":"string","dong_count":"string","house_count":"string","id":"string","new_address":"string","sido":"string","sigungu":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false}},"commonSetting":{}}}},"enabled":true,"fontSize":9},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1607319217209_-1169509248","id":"20181003-084238_933718271","dateCreated":"2020-12-07T05:33:37+0000","dateStarted":"2020-12-07T09:29:25+0000","dateFinished":"2020-12-07T09:29:36+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:30379"},{"title":"Write CSV","text":"%pyspark\n\nparquetDF.coalesce(1)\\\n.write\\\n.mode(\"Overwrite\")\\\n.format(\"csv\")\\\n.save(\"s3://fc-datapipeline/target/data33/master/csv/\")","user":"anonymous","dateUpdated":"2020-12-07T09:29:55+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","title":true,"results":{},"enabled":true,"fontSize":9},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1607319217210_607623036","id":"20181003-073224_251924060","dateCreated":"2020-12-07T05:33:37+0000","dateStarted":"2020-12-07T09:29:55+0000","dateFinished":"2020-12-07T09:29:57+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:30380"},{"user":"anonymous","dateUpdated":"2020-12-07T05:33:37+0000","config":{"colWidth":12,"editorMode":"ace/mode/scala","results":{},"enabled":true,"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"fontSize":9},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1607319217210_60251830","id":"20181003-085104_906540279","dateCreated":"2020-12-07T05:33:37+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:30381"}],"name":"1.readSource-pyspark","id":"2FTMQBQ3V","noteParams":{},"noteForms":{},"angularObjects":{"spark:shared_process":[]},"config":{"isZeppelinNotebookCronEnable":false,"looknfeel":"default","personalizedMode":"false"},"info":{}}