{"paragraphs":[{"title":"1. 초기화","text":"import java.sql.Connection\nimport java.sql.Statement\nimport java.sql.DriverManager","user":"anonymous","dateUpdated":"2020-12-08T05:48:50+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"import java.sql.Connection\nimport java.sql.Statement\nimport java.sql.DriverManager\n"}]},"apps":[],"jobName":"paragraph_1607319306692_805978643","id":"20181003-142451_1135253690","dateCreated":"2020-12-07T05:35:06+0000","dateStarted":"2020-12-08T05:48:50+0000","dateFinished":"2020-12-08T05:49:24+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:7985"},{"title":"2. RDS Read","text":"\nval url = \"jdbc:mysql://xx-xx-1.cp7ovqbewwso.ap-northeast-2.rds.amazonaws.com:3306/datamart?characterEncoding=UTF-8\"\nval user: String =\"admin\"\nval pass: String=\"xxx!\" \n \n \nval prop = new java.util.Properties\nprop.setProperty(\"driver\", \"com.mysql.jdbc.Driver\")\nprop.setProperty(\"user\", user)\nprop.setProperty(\"password\",pass) \n \n\n  \n \n \n  ","user":"anonymous","dateUpdated":"2020-12-08T06:02:29+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"title":true,"results":{},"enabled":true,"editorHide":false},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1607319306700_1274566972","id":"20181003-085444_189274594","dateCreated":"2020-12-07T05:35:06+0000","dateStarted":"2020-12-08T05:48:54+0000","dateFinished":"2020-12-08T05:49:25+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:7986","errorMessage":""},{"title":"3. RDS Write","text":"\nval csvDF = spark.read\n  .option(\"header\", \"true\")\n  .option(\"delimiter\", \",\")\n  .option(\"inferSchema\",\"true\")\n  .csv(\"s3://fc-datapipeline/danji_master.csv\")\n  ","user":"anonymous","dateUpdated":"2020-12-08T06:02:45+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"title":true,"results":{},"enabled":true,"editorHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"table1: String = danjimaster_njkwon\ncsvDF: org.apache.spark.sql.DataFrame = [id: int, danji_name: string ... 8 more fields]\n"}]},"apps":[],"jobName":"paragraph_1607319306703_823265151","id":"20181003-090359_1281629633","dateCreated":"2020-12-07T05:35:06+0000","dateStarted":"2020-12-08T05:49:25+0000","dateFinished":"2020-12-08T05:49:44+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:7987"},{"text":"\ncsvDF.createOrReplaceTempView(\"danji_master_pq\")","user":"anonymous","dateUpdated":"2020-12-08T06:02:58+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true,"editorHide":false,"title":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1607319306704_-1092279699","id":"20181003-142857_777437552","dateCreated":"2020-12-07T05:35:06+0000","dateStarted":"2020-12-08T06:00:06+0000","dateFinished":"2020-12-08T06:00:07+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:7988","title":"view Table 만들기"},{"title":"저장할 데이터 확인","text":"%sql\n\nselect id, \n       danji_name,\n       new_address,\n       sido,\n       sigungu,\n       dong\nfrom danji_master_pq","user":"anonymous","dateUpdated":"2020-12-08T06:03:59+0000","config":{"editorSetting":{"language":"sql","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/sql","fontSize":9,"title":true,"results":{"0":{"graph":{"mode":"table","height":300,"optionOpen":false,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{"id":"string","danji_name":"string","new_address":"string","sido":"string","sigungu":"string","dong":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false}},"commonSetting":{}}}},"enabled":true,"editorHide":false},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1607319306704_701889644","id":"20181003-142932_979333788","dateCreated":"2020-12-07T05:35:06+0000","dateStarted":"2020-12-08T06:00:10+0000","dateFinished":"2020-12-08T06:00:22+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:7989","errorMessage":""},{"title":"4.spark sql RDS Write","text":"val table1 = \"danji_master_[id]\"\n\nval df = spark.sql(\"\"\"\n            select id, \n                   danji_name,\n                   new_address,\n                   sido,\n                   sigungu,\n                   dong\n            from danji_master_pq\n                      \"\"\")\n\n df.write.mode(\"append\").jdbc(url, table1, prop)","user":"anonymous","dateUpdated":"2020-12-08T06:10:21+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"title":true,"results":{},"enabled":true,"editorHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"table1: String = danji_master_data33\ndf: org.apache.spark.sql.DataFrame = [id: int, danji_name: string ... 4 more fields]\n"}]},"apps":[],"jobName":"paragraph_1607319306704_1283473974","id":"20181003-142735_518824355","dateCreated":"2020-12-07T05:35:06+0000","dateStarted":"2020-12-08T06:01:23+0000","dateFinished":"2020-12-08T06:01:37+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:7990"},{"title":"5.read from RDS","text":" val areaQuery = \"\"\"(\n        select  *\n        from datamart.danji_master_[id] a\n\n ) a\"\"\"\n \n  val danjiMasterDF = spark.read.format(\"jdbc\").option(\"url\",url).option(\"dbtable\", areaQuery).option(\"user\", user).option(\"password\", pass).option(\"useUnicode\", \"true\").option(\"characterEncoding\",\"utf8\").load()","user":"anonymous","dateUpdated":"2020-12-08T06:10:12+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"title":true,"results":{},"enabled":true,"editorHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"areaQuery: String =\n(\n        select  *\n        from datamart.danji_master_data33 a\n\n ) a\ndanjiMasterDF: org.apache.spark.sql.DataFrame = [id: int, danji_name: string ... 4 more fields]\n"}]},"apps":[],"jobName":"paragraph_1607319306705_-791656238","id":"20200117-133831_197074300","dateCreated":"2020-12-07T05:35:06+0000","dateStarted":"2020-12-08T06:01:42+0000","dateFinished":"2020-12-08T06:01:43+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:7991"},{"text":"danjiMasterDF.show","user":"anonymous","dateUpdated":"2020-12-08T06:12:11+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true,"editorHide":false,"title":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1607319306705_-752740422","id":"20200117-134302_1285561776","dateCreated":"2020-12-07T05:35:06+0000","dateStarted":"2020-12-08T06:01:46+0000","dateFinished":"2020-12-08T06:01:47+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:7992","errorMessage":"","title":"6. 데이터확인"},{"user":"anonymous","dateUpdated":"2020-12-07T05:35:06+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1607319306706_1058619992","id":"20200117-134452_200442516","dateCreated":"2020-12-07T05:35:06+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:7993"}],"name":"3.RDS read write-scala","id":"2FRDR9BVZ","noteParams":{},"noteForms":{},"angularObjects":{"spark:shared_process":[]},"config":{"isZeppelinNotebookCronEnable":false,"looknfeel":"default","personalizedMode":"false"},"info":{}}